<UserControl
    x:Class="Eventa.Views.Events.CreateEditDeleteOrganizerEventView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:asyncImageLoader="clr-namespace:AsyncImageLoader;assembly=AsyncImageLoader.Avalonia"
    xmlns:controls="clr-namespace:Eventa.Controls;assembly=Eventa"
    xmlns:converters="clr-namespace:Eventa.Converters;assembly=Eventa"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="clr-namespace:Eventa.Models.Events.Organizer;assembly=Eventa"
    xmlns:vm="clr-namespace:Eventa.ViewModels.Events;assembly=Eventa"
    d:DesignHeight="1650"
    d:DesignWidth="800"
    x:DataType="vm:CreateEditDeleteOrganizerEventViewModel"
    mc:Ignorable="d">
    <UserControl.Styles>
        <Style Selector="TextBox, AutoCompleteBox">
            <Setter Property="Margin" Value="0,0,0,15" />
            <Setter Property="Padding" Value="12,10" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="FontFamily" Value="{StaticResource Kadwa}" />
        </Style>
        <Style Selector="TextBox:focus, AutoCompleteBox:focus">
            <Setter Property="BorderBrush" Value="#FFB5B5" />
        </Style>
        <Style Selector="TextBlock.Label">
            <Setter Property="FontFamily" Value="{StaticResource Kadwa}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Foreground" Value="#666666" />
            <Setter Property="Margin" Value="0,0,0,5" />
        </Style>
        <Style Selector="TextBlock">
            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
        </Style>
        <!--  Style for the CalendarDatePicker button  -->
        <Style Selector="CalendarDatePicker">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Padding" Value="12,8" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="#999999" />
        </Style>

        <!--  Calendar popup styling  -->
        <Style Selector="Calendar">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="16" />
        </Style>

        <!--  Calendar header (month/year navigation)  -->
        <Style Selector="Calendar CalendarButton">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="#333333" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>

        <!--  Navigation buttons  -->
        <Style Selector="Calendar Button.PreviousButton, Calendar Button.NextButton">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Width" Value="32" />
            <Setter Property="Height" Value="32" />
            <Setter Property="Foreground" Value="#666666" />
        </Style>

        <Style Selector="Calendar Button.PreviousButton:pointerover, Calendar Button.NextButton:pointerover">
            <Setter Property="Background" Value="#F5F5F5" />
            <Setter Property="CornerRadius" Value="16" />
        </Style>

        <!--  Day of week headers  -->
        <Style Selector="Calendar CalendarDayButton.DayTitleButton">
            <Setter Property="Foreground" Value="#999999" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="IsHitTestVisible" Value="False" />
        </Style>

        <!--  Calendar day buttons  -->
        <Style Selector="Calendar CalendarDayButton">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="#333333" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Width" Value="40" />
            <Setter Property="Height" Value="40" />
            <Setter Property="Margin" Value="2" />
            <Setter Property="CornerRadius" Value="20" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>

        <!--  Hover state for day buttons  -->
        <Style Selector="Calendar CalendarDayButton:pointerover">
            <Setter Property="Background" Value="#F5F5F5" />
        </Style>

        <!--  Selected/Today button styling (pink circle)  -->
        <Style Selector="Calendar CalendarDayButton.selected, Calendar CalendarDayButton:selected">
            <Setter Property="Background" Value="#FF6B9D" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <Style Selector="Calendar CalendarDayButton.selected:pointerover">
            <Setter Property="Background" Value="#FF5A8C" />
        </Style>

        <!--  Inactive days (previous/next month)  -->
        <Style Selector="Calendar CalendarDayButton.inactive">
            <Setter Property="Foreground" Value="#CCCCCC" />
        </Style>

        <!--  Action buttons (Cancel/OK)  -->
        <Style Selector="CalendarDatePicker Button.AcceptButton">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="#FF6B9D" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="Medium" />
        </Style>

        <Style Selector="CalendarDatePicker Button.DismissButton">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="#FF6B9D" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="Medium" />
        </Style>

        <Style Selector="CalendarDatePicker Button.AcceptButton:pointerover, CalendarDatePicker Button.DismissButton:pointerover">
            <Setter Property="Background" Value="#FFF0F5" />
        </Style>
    </UserControl.Styles>
    <UserControl.Resources>
        <converters:StringNotEmptyConverter x:Key="StringNotEmpty" />
        <converters:BoolToStringConverter x:Key="BoolToStringConverter" />
    </UserControl.Resources>

    <!--  Main Content  -->
    <ScrollViewer Background="#F5F5F5">
        <Grid HorizontalAlignment="Center" RowDefinitions="auto, *">
            <!--  Page Title  -->
            <TextBlock
                Grid.Row="0"
                Margin="0,30,0,20"
                HorizontalAlignment="Center"
                FontFamily="{StaticResource Kadwa}"
                FontSize="28"
                Foreground="#FF9999"
                Text="{Binding IsEditMode, Converter={StaticResource BoolToStringConverter}, ConverterParameter='Edit Event|Create Event'}" />

            <!--  Form Card  -->
            <Border
                Grid.Row="1"
                Width="350"
                Margin="20,0,20,40"
                Padding="40"
                Background="White"
                BoxShadow="0 4 20 0 #30000000"
                CornerRadius="12">
                <Grid RowDefinitions="auto, auto, auto, auto, auto">
                    <!--  Image Upload Section  -->
                    <StackPanel Grid.Row="0" Margin="0,0,0,25">
                        <Border
                            Width="200"
                            Height="200"
                            Margin="0,0,0,15"
                            HorizontalAlignment="Center"
                            Background="#F5F5F5"
                            BorderBrush="#E0E0E0"
                            BorderThickness="2">
                            <Grid>
                                <asyncImageLoader:AdvancedImage
                                    IsVisible="{Binding EventImage, Converter={StaticResource StringNotEmpty}}"
                                    Source="{Binding EventImage}"
                                    Stretch="UniformToFill" />
                                <PathIcon
                                    Width="60"
                                    Height="60"
                                    Data="M19,13A1,1 0 0,0 18,14V18A1,1 0 0,0 19,19H23A1,1 0 0,0 24,18V14A1,1 0 0,0 23,13M19,15H23V18H19M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5M22,3H5A2,2 0 0,0 3,5V17A2,2 0 0,0 5,19H22A2,2 0 0,0 24,17V5A2,2 0 0,0 22,3M22,17H5V5H22Z"
                                    Foreground="#CCCCCC"
                                    IsVisible="{Binding EventImage, Converter={StaticResource StringNotEmpty}, ConverterParameter=Invert}" />
                            </Grid>
                        </Border>
                        <Button
                            Name="UploadImageButton"
                            Padding="20,8"
                            HorizontalAlignment="Center"
                            Background="Transparent"
                            BorderBrush="#FFB5B5"
                            BorderThickness="1"
                            Command="{Binding UploadImageCommand}"
                            CornerRadius="6"
                            Cursor="Hand"
                            FontFamily="{StaticResource Kadwa}"
                            FontSize="13"
                            Foreground="#FF8181">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#FCE0E0" />
                                </Style>
                            </Button.Styles>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <PathIcon
                                    Width="16"
                                    Height="16"
                                    Data="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"
                                    Foreground="#FF8181" />
                                <TextBlock Text="Upload Image" />
                            </StackPanel>
                        </Button>
                    </StackPanel>

                    <!--  Event Details Form  -->
                    <Grid Grid.Row="1" RowDefinitions="auto, auto, auto, auto, auto, auto, auto, auto">
                        <!--  Event Name  -->
                        <StackPanel Grid.Row="0">
                            <TextBlock Classes="Label" Text="Event name:" />
                            <TextBox
                                Name="EventNameTextBox"
                                Text="{Binding EventName, Mode=TwoWay}"
                                Watermark="Enter event name" />
                        </StackPanel>

                        <!--  Event Place  -->
                        <StackPanel Grid.Row="1">
                            <TextBlock Classes="Label" Text="Event place:" />
                            <AutoCompleteBox
                                Name="EventPlaceAutoCompleteBox"
                                HorizontalAlignment="Stretch"
                                FilterMode="ContainsOrdinal"
                                ItemsSource="{Binding AvailablePlaces}"
                                SelectedItem="{Binding SelectedPlace, Mode=TwoWay}"
                                Watermark="Search for a place...">
                                <AutoCompleteBox.ItemTemplate>
                                    <DataTemplate DataType="models:PlaceResponseModel">
                                        <TextBlock>
                                            <Run Text="{Binding Name}" />
                                            <Run Text="{Binding Address}" />
                                        </TextBlock>
                                    </DataTemplate>
                                </AutoCompleteBox.ItemTemplate>
                            </AutoCompleteBox>
                        </StackPanel>

                        <!--  Event Time  -->
                        <StackPanel Grid.Row="2">
                            <TextBlock Classes="Label" Text="Event time:" />
                            <TextBox
                                Name="EventTimeTextBox"
                                Text="{Binding EventTime, Mode=TwoWay}"
                                Watermark="HH:MM" />
                        </StackPanel>

                        <!--  Event Duration  -->
                        <StackPanel Grid.Row="3">
                            <TextBlock Classes="Label" Text="Event duration:" />
                            <TextBox
                                Name="EventDurationTextBox"
                                Text="{Binding EventDuration, Mode=TwoWay}"
                                Watermark="Duration in minutes" />
                        </StackPanel>

                        <!--  Event Date  -->
                        <StackPanel Grid.Row="4">
                            <TextBlock Classes="Label" Text="Event date:" />
                            <CalendarDatePicker
                                Margin="0,0,0,10"
                                HorizontalAlignment="Stretch"
                                BorderBrush="#E0E0E0"
                                SelectedDate="{Binding SelectedEventDate}" />
                        </StackPanel>

                        <!--  Description  -->
                        <StackPanel Grid.Row="5">
                            <TextBlock Classes="Label" Text="Description:" />
                            <TextBox
                                Name="DescriptionTextBox"
                                Height="100"
                                AcceptsReturn="True"
                                Text="{Binding Description, Mode=TwoWay}"
                                TextWrapping="Wrap"
                                Watermark="Enter event description..." />
                        </StackPanel>

                        <!--  Standard Ticket Price  -->
                        <StackPanel Grid.Row="6">
                            <TextBlock Classes="Label" Text="Standard ticket price:" />
                            <TextBox
                                Name="TicketPriceTextBox"
                                Text="{Binding TicketPrice, Mode=TwoWay}"
                                Watermark="0.00$" />
                        </StackPanel>

                        <!--  Tags  -->
                        <StackPanel Grid.Row="7">
                            <TextBlock Classes="Label" Text="Tags:" />
                            <controls:TagContainer AvailableTags="{Binding AvailableTags}" SelectedTags="{Binding SelectedTags, Mode=TwoWay}" />
                        </StackPanel>
                    </Grid>

                    <StackPanel Grid.Row="2" Margin="0,25,0,0">
                        <Grid Margin="0,0,0,15" ColumnDefinitions="*, Auto">
                            <TextBlock
                                Grid.Column="0"
                                Margin="0"
                                VerticalAlignment="Center"
                                Classes="Label"
                                FontSize="15"
                                FontWeight="SemiBold"
                                Foreground="#FF9999"
                                Text="Additional dates (optional)" />
                            <Button
                                Grid.Column="1"
                                Padding="8"
                                Background="Transparent"
                                BorderThickness="0"
                                Command="{Binding AddDateCommand}"
                                CornerRadius="4"
                                Cursor="Hand">
                                <Button.Styles>
                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                        <Setter Property="Background" Value="#FCE0E0" />
                                    </Style>
                                </Button.Styles>
                                <PathIcon
                                    Width="20"
                                    Height="20"
                                    Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"
                                    Foreground="#FF8181" />
                            </Button>
                        </Grid>

                        <!--  Additional Dates Section  -->
                        <StackPanel Grid.Row="2" Margin="0,25,0,0">
                            <ItemsControl ItemsSource="{Binding AdditionalDates}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border
                                            Margin="0,0,0,15"
                                            Padding="15"
                                            Background="#FAFAFA"
                                            BorderBrush="#E0E0E0"
                                            BorderThickness="1"
                                            CornerRadius="8">
                                            <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto, Auto, Auto, Auto">
                                                <!--  Event Time  -->
                                                <StackPanel Grid.Row="0" Grid.Column="0">
                                                    <TextBlock Classes="Label" Text="Event time:" />
                                                    <TextBox Text="{Binding Time, Mode=TwoWay}" Watermark="HH:MM" />
                                                </StackPanel>

                                                <!--  Event Duration  -->
                                                <StackPanel Grid.Row="1" Grid.Column="0">
                                                    <TextBlock Classes="Label" Text="Event duration:" />
                                                    <TextBox Text="{Binding Duration, Mode=TwoWay}" Watermark="Duration in minutes" />
                                                </StackPanel>

                                                <!--  Event Date  -->
                                                <StackPanel Grid.Row="2" Grid.Column="0">
                                                    <TextBlock Classes="Label" Text="Event date:" />
                                                    <CalendarDatePicker
                                                        HorizontalAlignment="Stretch"
                                                        BorderBrush="#E0E0E0"
                                                        SelectedDate="{Binding Date, Mode=TwoWay}" />
                                                </StackPanel>

                                                <!--  Remove Button  -->
                                                <Button
                                                    Grid.Row="0"
                                                    Grid.Column="1"
                                                    Margin="8,0,0,0"
                                                    Padding="8"
                                                    VerticalAlignment="Top"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    Command="{Binding $parent[UserControl].((vm:CreateEditDeleteOrganizerEventViewModel)DataContext).RemoveDateCommand}"
                                                    CommandParameter="{Binding}"
                                                    CornerRadius="4"
                                                    Cursor="Hand">
                                                    <Button.Styles>
                                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                            <Setter Property="Background" Value="#FFE0E0" />
                                                        </Style>
                                                    </Button.Styles>
                                                    <PathIcon
                                                        Width="20"
                                                        Height="20"
                                                        Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"
                                                        Foreground="#FF8181" />
                                                </Button>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </StackPanel>

                    <!--  Error Message  -->
                    <ScrollViewer
                        Grid.Row="3"
                        MaxWidth="400"
                        MaxHeight="80"
                        Margin="0,15,0,0"
                        IsScrollChainingEnabled="False">
                        <TextBlock
                            FontFamily="{StaticResource Kadwa}"
                            Foreground="#FF8181"
                            IsVisible="{Binding ErrorMessage, Converter={StaticResource StringNotEmpty}}"
                            Text="{Binding ErrorMessage}"
                            TextAlignment="Center"
                            TextWrapping="WrapWithOverflow" />
                    </ScrollViewer>

                    <!--  Action Buttons  -->
                    <Grid Grid.Row="4" Margin="0,25,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="auto" />
                        </Grid.ColumnDefinitions>

                        <Button
                            Grid.Column="0"
                            Margin="0,0,8,0"
                            Padding="0,12"
                            HorizontalAlignment="Stretch"
                            Background="#F5F5F5"
                            BorderBrush="#E0E0E0"
                            BorderThickness="1"
                            Command="{Binding CancelCommand}"
                            CornerRadius="8"
                            Cursor="Hand"
                            FontFamily="{StaticResource Kadwa}"
                            FontSize="16"
                            Foreground="#666666">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#EEEEEE" />
                                </Style>
                            </Button.Styles>
                            <TextBlock Text="Cancel" TextAlignment="Center" />
                        </Button>

                        <Button
                            Grid.Column="1"
                            Margin="8,0,8,0"
                            Padding="0,12"
                            HorizontalAlignment="Stretch"
                            Background="#FFB5B5"
                            BorderThickness="0"
                            Command="{Binding SaveEventCommand}"
                            CornerRadius="8"
                            Cursor="Hand"
                            FontFamily="{StaticResource Kadwa}"
                            FontSize="16"
                            Foreground="White">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#FF9999" />
                                </Style>
                            </Button.Styles>
                            <TextBlock Text="{Binding IsEditMode, Converter={StaticResource BoolToStringConverter}, ConverterParameter='Update|Create'}" TextAlignment="Center" />
                        </Button>

                        <!--  Delete Button (only visible in edit mode)  -->
                        <Button
                            Grid.Column="2"
                            Width="75"
                            Margin="8,0,8,0"
                            Padding="0,12"
                            HorizontalAlignment="Stretch"
                            Background="#FFB5B5"
                            BorderThickness="0"
                            Command="{Binding DeleteEventCommand}"
                            CornerRadius="8"
                            Cursor="Hand"
                            FontFamily="{StaticResource Kadwa}"
                            FontSize="16"
                            Foreground="White"
                            IsVisible="{Binding IsEditMode}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#FFCCCC" />
                                </Style>
                            </Button.Styles>
                            <TextBlock Text="Delete" TextAlignment="Center" />
                        </Button>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>