<UserControl
    x:Class="Eventa.Views.Events.CreateOrganizerEventView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:Eventa.Converters;assembly=Eventa"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:Eventa.ViewModels.Events;assembly=Eventa"
    d:DesignHeight="750"
    d:DesignWidth="800"
    x:DataType="vm:CreateOrganizerEventViewModel"
    mc:Ignorable="d">
    <UserControl.Styles>
        <Style Selector="TextBox, ComboBox">
            <Setter Property="Margin" Value="0,0,0,15" />
            <Setter Property="Padding" Value="12,10" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="FontFamily" Value="{StaticResource Kadwa}" />
        </Style>
        <Style Selector="TextBox:focus, ComboBox:focus">
            <Setter Property="BorderBrush" Value="#FFB5B5" />
        </Style>
        <Style Selector="TextBlock.Label">
            <Setter Property="FontFamily" Value="{StaticResource Kadwa}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Foreground" Value="#666666" />
            <Setter Property="Margin" Value="0,0,0,5" />
        </Style>
        <Style Selector="TextBlock">
            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
        </Style>
    </UserControl.Styles>
    <UserControl.Resources>
        <converters:StringNotEmptyConverter x:Key="StringNotEmpty" />
    </UserControl.Resources>

    <!--  Main Content  -->
    <ScrollViewer Background="#F5F5F5">
        <Grid HorizontalAlignment="Center" RowDefinitions="auto, *">
            <!--  Page Title  -->
            <TextBlock
                Grid.Row="0"
                Margin="0,30,0,20"
                HorizontalAlignment="Center"
                FontFamily="{StaticResource Kadwa}"
                FontSize="28"
                Foreground="#FF9999"
                Text="{Binding IsEditMode, Converter={StaticResource StringNotEmpty}, ConverterParameter='Edit Event|Create Event'}" />

            <!--  Form Card  -->
            <Border
                Grid.Row="1"
                MaxWidth="600"
                Margin="20,0,20,40"
                Padding="40"
                Background="White"
                BoxShadow="0 4 20 0 #30000000"
                CornerRadius="12">
                <Grid RowDefinitions="auto, auto, auto, auto, auto">
                    <!--  Image Upload Section  -->
                    <StackPanel Grid.Row="0" Margin="0,0,0,25">
                        <Border
                            Width="200"
                            Height="200"
                            Margin="0,0,0,15"
                            HorizontalAlignment="Center"
                            Background="#F5F5F5"
                            BorderBrush="#E0E0E0"
                            BorderThickness="2"
                            CornerRadius="8">
                            <Grid>
                                <Image
                                    IsVisible="{Binding EventImage, Converter={StaticResource StringNotEmpty}}"
                                    Source="{Binding EventImage}"
                                    Stretch="UniformToFill" />
                                <PathIcon
                                    Width="60"
                                    Height="60"
                                    Data="M19,13A1,1 0 0,0 18,14V18A1,1 0 0,0 19,19H23A1,1 0 0,0 24,18V14A1,1 0 0,0 23,13M19,15H23V18H19M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5M22,3H5A2,2 0 0,0 3,5V17A2,2 0 0,0 5,19H22A2,2 0 0,0 24,17V5A2,2 0 0,0 22,3M22,17H5V5H22Z"
                                    Foreground="#CCCCCC"
                                    IsVisible="{Binding EventImage, Converter={StaticResource StringNotEmpty}, ConverterParameter=Invert}" />
                            </Grid>
                        </Border>
                        <Button
                            Padding="20,8"
                            HorizontalAlignment="Center"
                            Background="Transparent"
                            BorderBrush="#FFB5B5"
                            BorderThickness="1"
                            Command="{Binding UploadImageCommand}"
                            CornerRadius="6"
                            Cursor="Hand"
                            FontFamily="{StaticResource Kadwa}"
                            FontSize="13"
                            Foreground="#FF8181">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#FCE0E0" />
                                </Style>
                            </Button.Styles>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <PathIcon
                                    Width="16"
                                    Height="16"
                                    Data="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"
                                    Foreground="#FF8181" />
                                <TextBlock Text="Upload Image" />
                            </StackPanel>
                        </Button>
                    </StackPanel>

                    <!--  Event Details Form  -->
                    <Grid Grid.Row="1" RowDefinitions="auto, auto, auto, auto, auto, auto, auto">
                        <!--  Event Name  -->
                        <StackPanel Grid.Row="0">
                            <TextBlock Classes="Label" Text="Event name:" />
                            <TextBox
                                Name="EventNameTextBox"
                                Text="{Binding EventName, Mode=TwoWay}"
                                Watermark="Enter event name" />
                        </StackPanel>

                        <!--  Event Place  -->
                        <StackPanel Grid.Row="1">
                            <TextBlock Classes="Label" Text="Event place:" />
                            <ComboBox
                                Name="EventPlaceComboBox"
                                HorizontalAlignment="Stretch"
                                ItemsSource="{Binding AvailablePlaces}"
                                SelectedItem="{Binding SelectedPlace, Mode=TwoWay}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>

                        <!--  Event Time  -->
                        <StackPanel Grid.Row="2">
                            <TextBlock Classes="Label" Text="Event time:" />
                            <TextBox
                                Name="EventTimeTextBox"
                                Text="{Binding EventTime, Mode=TwoWay}"
                                Watermark="HH:MM" />
                        </StackPanel>

                        <!--  Event Duration  -->
                        <StackPanel Grid.Row="3">
                            <TextBlock Classes="Label" Text="Event duration:" />
                            <Grid ColumnDefinitions="*, Auto">
                                <TextBox
                                    Name="EventDurationTextBox"
                                    Text="{Binding EventDuration, Mode=TwoWay}"
                                    Watermark="Duration in minutes" />
                                <Button
                                    Grid.Column="1"
                                    Margin="-55,0,5,15"
                                    Padding="8"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Command="{Binding SelectEventDateCommand}"
                                    CornerRadius="4"
                                    Cursor="Hand">
                                    <Button.Styles>
                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                            <Setter Property="Background" Value="#FCE0E0" />
                                        </Style>
                                    </Button.Styles>
                                    <PathIcon
                                        Width="16"
                                        Height="16"
                                        Data="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z"
                                        Foreground="#FF8181" />
                                </Button>
                            </Grid>
                        </StackPanel>

                        <!--  Description  -->
                        <StackPanel Grid.Row="4">
                            <TextBlock Classes="Label" Text="Description:" />
                            <TextBox
                                Name="DescriptionTextBox"
                                Height="100"
                                AcceptsReturn="True"
                                Text="{Binding Description, Mode=TwoWay}"
                                TextWrapping="Wrap"
                                Watermark="Enter event description..." />
                        </StackPanel>

                        <!--  Standard Ticket Price  -->
                        <StackPanel Grid.Row="5">
                            <TextBlock Classes="Label" Text="Standard ticket price:" />
                            <TextBox
                                Name="TicketPriceTextBox"
                                Text="{Binding TicketPrice, Mode=TwoWay}"
                                Watermark="0.00" />
                        </StackPanel>

                        <!--  Tags  -->
                        <StackPanel Grid.Row="6">
                            <TextBlock Classes="Label" Text="Tags:" />
                            <ComboBox
                                Name="TagsComboBox"
                                HorizontalAlignment="Stretch"
                                ItemsSource="{Binding AvailableTags}"
                                SelectedItem="{Binding SelectedTag, Mode=TwoWay}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                    </Grid>

                    <!--  Additional Dates Section  -->
                    <StackPanel Grid.Row="2" Margin="0,25,0,0">
                        <Grid Margin="0,0,0,15" ColumnDefinitions="*, Auto">
                            <TextBlock
                                Grid.Column="0"
                                Margin="0"
                                VerticalAlignment="Center"
                                Classes="Label"
                                FontSize="15"
                                FontWeight="SemiBold"
                                Foreground="#FF9999"
                                Text="Additional dates (optional)" />
                            <Button
                                Grid.Column="1"
                                Padding="8"
                                Background="Transparent"
                                BorderThickness="0"
                                Command="{Binding AddDateCommand}"
                                CornerRadius="4"
                                Cursor="Hand">
                                <Button.Styles>
                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                        <Setter Property="Background" Value="#FCE0E0" />
                                    </Style>
                                </Button.Styles>
                                <PathIcon
                                    Width="20"
                                    Height="20"
                                    Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"
                                    Foreground="#FF8181" />
                            </Button>
                        </Grid>

                        <ItemsControl ItemsSource="{Binding AdditionalDates}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="0,0,0,15" ColumnDefinitions="*, *, Auto">
                                        <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                            <TextBlock Classes="Label" Text="Event place:" />
                                            <ComboBox
                                                HorizontalAlignment="Stretch"
                                                ItemsSource="{Binding $parent[UserControl].((vm:CreateOrganizerEventViewModel)DataContext).AvailablePlaces}"
                                                SelectedItem="{Binding Place, Mode=TwoWay}" />
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" Margin="8,0,8,0">
                                            <TextBlock Classes="Label" Text="Event duration:" />
                                            <Grid ColumnDefinitions="*, Auto">
                                                <TextBox Text="{Binding Duration, Mode=TwoWay}" Watermark="Duration" />
                                                <Button
                                                    Grid.Column="1"
                                                    Margin="-55,0,5,15"
                                                    Padding="8"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    CornerRadius="4"
                                                    Cursor="Hand">
                                                    <Button.Styles>
                                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                            <Setter Property="Background" Value="#FCE0E0" />
                                                        </Style>
                                                    </Button.Styles>
                                                    <PathIcon
                                                        Width="16"
                                                        Height="16"
                                                        Data="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z"
                                                        Foreground="#FF8181" />
                                                </Button>
                                            </Grid>
                                        </StackPanel>
                                        <Button
                                            Grid.Column="2"
                                            Margin="0,0,0,15"
                                            Padding="8"
                                            VerticalAlignment="Bottom"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Command="{Binding $parent[UserControl].((vm:CreateOrganizerEventViewModel)DataContext).RemoveDateCommand}"
                                            CommandParameter="{Binding}"
                                            CornerRadius="4"
                                            Cursor="Hand">
                                            <Button.Styles>
                                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                    <Setter Property="Background" Value="#FFE0E0" />
                                                </Style>
                                            </Button.Styles>
                                            <PathIcon
                                                Width="20"
                                                Height="20"
                                                Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"
                                                Foreground="#FF8181" />
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>

                    <!--  Error Message  -->
                    <ScrollViewer
                        Grid.Row="3"
                        MaxWidth="400"
                        MaxHeight="80"
                        Margin="0,15,0,0"
                        IsScrollChainingEnabled="False">
                        <TextBlock
                            FontFamily="{StaticResource Kadwa}"
                            Foreground="#FF8181"
                            IsVisible="{Binding ErrorMessage, Converter={StaticResource StringNotEmpty}}"
                            Text="{Binding ErrorMessage}"
                            TextAlignment="Center"
                            TextWrapping="WrapWithOverflow" />
                    </ScrollViewer>

                    <!--  Action Buttons  -->
                    <Grid Grid.Row="4" Margin="0,25,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Button
                            Grid.Column="0"
                            Margin="0,0,8,0"
                            Padding="0,12"
                            HorizontalAlignment="Stretch"
                            Background="#F5F5F5"
                            BorderBrush="#E0E0E0"
                            BorderThickness="1"
                            Command="{Binding CancelCommand}"
                            CornerRadius="8"
                            Cursor="Hand"
                            FontFamily="{StaticResource Kadwa}"
                            FontSize="16"
                            Foreground="#666666">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#EEEEEE" />
                                </Style>
                            </Button.Styles>
                            Cancel
                        </Button>

                        <Button
                            Grid.Column="1"
                            Margin="8,0,8,0"
                            Padding="0,12"
                            HorizontalAlignment="Stretch"
                            Background="#FFB5B5"
                            BorderThickness="0"
                            Command="{Binding SaveEventCommand}"
                            CornerRadius="8"
                            Cursor="Hand"
                            FontFamily="{StaticResource Kadwa}"
                            FontSize="16"
                            Foreground="White">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#FF9999" />
                                </Style>
                            </Button.Styles>
                            <TextBlock Text="{Binding IsEditMode, Converter={StaticResource StringNotEmpty}, ConverterParameter='Update|Create'}" />
                        </Button>

                        <!--  Delete Button (only visible in edit mode)  -->
                        <Button
                            Grid.Column="2"
                            Margin="8,0,0,0"
                            Padding="12"
                            Background="#FFE0E0"
                            BorderThickness="0"
                            Command="{Binding DeleteEventCommand}"
                            CornerRadius="8"
                            Cursor="Hand"
                            IsVisible="{Binding IsEditMode, Converter={StaticResource StringNotEmpty}}">
                            <Button.Styles>
                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                    <Setter Property="Background" Value="#FFCCCC" />
                                </Style>
                            </Button.Styles>
                            <PathIcon
                                Width="20"
                                Height="20"
                                Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"
                                Foreground="#FF8181" />
                        </Button>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>